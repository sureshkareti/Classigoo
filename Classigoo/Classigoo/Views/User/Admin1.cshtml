@model IEnumerable<Add>
@{

    ViewBag.Title = "Admin";
    Layout = "~/Views/Shared/_Layout.cshtml";

    List<SelectListItem> statusCollection = new List<SelectListItem>();

    statusCollection.Add(new SelectListItem { Text = Constants.PendingSatus, Value = Constants.PendingSatus });
    statusCollection.Add(new SelectListItem { Text = Constants.ReviewSatus, Value = Constants.ReviewSatus });
    statusCollection.Add(new SelectListItem { Text = Constants.ActiveSatus, Value = Constants.ActiveSatus });
    statusCollection.Add(new SelectListItem { Text = Constants.DeactiveSatus, Value = Constants.DeactiveSatus });
    statusCollection.Add(new SelectListItem { Text = Constants.RejectSatus, Value = Constants.RejectSatus });
}

@using (Html.BeginForm("Admin1", "Post", FormMethod.Post, new { name = "defaultForm", id = "defaultForm", data_toggle = "validator", @enctype = "multipart/form-data" }))
{


    <div>



    </div>

    <div>
        <div class="breadcrumb-block">

        </div>
        <div class="add-listing-wrap">
            <div class="container">


                <div class="add-listing-tost-block">
                    <p></p>
                </div>

                <div class="add-listing-tost-block" style="width:100%; padding:15px 15px 15px 15px;border-radius:3px;box-shadow:0px 1px 11px -1px rgba(216, 216, 216, 0.75)">

                    <table id="tblAdds" class="table table-striped table-bordered nowrap" style="width:100%">
                        <thead>
                            <tr>
                                <th data-class="expand">AddId</th>
                                <th data-hide="phone">Created</th>
                                <th data-hide="phone">Category</th>
                                <th data-hide="phone">State</th>
                                <th data-hide="phone">District</th>
                                <th data-hide="phone">Mandal</th>
                                <th data-hide="phone">UserName</th>
                                <th data-hide="phone">Mobile</th>
                                <th data-hide="phone">Rent/Sale</th>
                                <th>Preview</th>
                                <th>Status</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model)
                            {

                                <tr>
                                    <td id="addId">
                                        @item.AddId
                                    </td>
                                    <td>
                                        @item.Created
                                    </td>
                                    <td>
                                        @item.Category
                                    </td>
                                    <td>
                                        @item.State
                                    </td>
                                    <td>
                                        @item.District
                                    </td>
                                    <td>
                                        @item.Mandal
                                    </td>
                                    <td>
                                        suresh kareti
                                    </td>
                                    <td>
                                        9014454730
                                    </td>
                                    <td>
                                        Rent
                                    </td>
                                    <td>
                                        @Html.ActionLink("Preview", "PreviewAdd", "User", new { addId = @item.AddId }, new { target = "_blank" })

                                    </td>
                                    <td>
                                        <span class="display-mode"> <label id="lblSurName">@item.Status</label></span>
                                        @Html.DropDownList("ddlStatus", statusCollection, new { @class = "edit-mode" })
                                    </td>
                                    <td>
                                        <input type="button" value="Edit" class="edit-user display-mode" />
                                        <button class="save-user edit-mode">Save</button>
                                        <button class="cancel-user edit-mode">Cancel</button>
                                    </td>
                                </tr>

                            }
                        </tbody>
                        <tfoot>

                        </tfoot>
                    </table>

                </div>


            </div>
        </div>
    </div>

}

<div class="loader-wrap" style="display:none">
    <div class="loader">
        <span class="loader-item"></span><span class="loader-item"></span><span class="loader-item"></span><span class="loader-item"></span><span class="loader-item"></span><span class="loader-item"></span><span class="loader-item"></span><span class="loader-item"></span>
        <span class="loader-item"></span><span class="loader-item"></span>
    </div>
</div>
@section Styles {

    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.datatables.net/1.10.16/css/dataTables.bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.1/css/responsive.bootstrap.min.css" />


    @*<link href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />*@
    @*<link rel="stylesheet" href="https://cdn.datatables.net/fixedheader/3.1.3/css/fixedHeader.bootstrap.min.css" />*@


}


@section scripts{

    <script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.16/js/dataTables.bootstrap.min.js"></script>

    <script src="https://cdn.datatables.net/responsive/2.2.1/js/dataTables.responsive.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.2.1/js/responsive.bootstrap.min.js"></script>


    @*<script src="https://cdn.datatables.net/fixedheader/3.1.3/js/dataTables.fixedHeader.min.js"></script>*@


    @*<script src="https://cdn.datatables.net/responsive/2.2.1/js/dataTables.responsive.min.js"></script>*@
    @*<script src="https://cdn.datatables.net/responsive/2.2.1/js/responsive.bootstrap.min.js"></script>*@


}

<script type="text/javascript">
    $(document).ready(function () {

        $('.edit-mode').css("display", "none");

       

        var table = $('#tblAdds').DataTable({
            "responsive": true,

            "columnDefs": [{ "targets": -1, "data": null, "defaultContent": "<input id='btnDetails' class='btn btn-success' width='25px' value='Get Details' />" }]

        });

        new $.fn.dataTable.FixedHeader(table);

        $('.edit-user').click(function () {
            alert("gelo");
        })

        $('#tblAdds tbody').on('click', '[id*=btnDetails]', function () {
            alert("hey");
            var data = table.row($(this).parents('tr')).data();
            var customerID = data[0];
            var name = data[1];
            var title = data[2];
            var city = data[3];
            alert("Customer ID : " + customerID + "\n" + "Name : " + name + "\n" + "Title : " + title + "\n" + "City : " + city);
        });

        $('.save-user').on('click', function () {
            $(".loader-wrap").show();
            var tr = $(this).parents('tr:first');
            var status = tr.find("#ddlStatus").val();
            var addId = tr.find("#addId").text();
            $.ajax({
                url: '/User/UpdateAddStatus/',
                data: { addId: addId, status: status },
                type: 'GET',
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    window.location.href = "/User/Admin";
                    $(".loader-wrap").hide();
                },
                failure: function (response) {
                    console.log(response.responseText);
                },
                error: function (response) {
                    console.log(response.responseText);
                }
            });
        });

    });
</script>

